<!DOCTYPE html>
<html>
<head>
  <link href='https://fonts.googleapis.com/css?family=Roboto:400,700' rel='stylesheet' type='text/css'>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet" href="https://skiadas.github.io/css/course.css" type="text/css" />
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>
<body>
<h2 id="changes-over-time">Changes over Time</h2>
<p>……….</p>
<p>Overflow from lab 5 – use for lab 6?</p>
<p>Note: It’s very interesting that in 2010, Americans 65 and over are 13% of the population, but are a much larger proportion of the 2010 data in brfss. A good opportunity to discuss sampling methods, over/under sampling, etc.?</p>
<h2 id="height">Height</h2>
<ol start="14" style="list-style-type: decimal">
<li><p>Draw a basic histogram of the <code>height</code> variable using the <code>brfss</code> data. Is this a good view of the data? Explain.</p></li>
<li><p>In order to focus in on the typical values for the <code>height</code> variable, we can pipe the data through a filter to remove the tails. Let’s keep the middle 99% of the values. First find the quantiles for 0.005 (the lowest 1/2-percent) and 0.995 (the highest 1/2-percent) and then them to form a subset of the heights:</p>
<pre class="{r}"><code>lowCutoff &lt;- quantile(~height, data=brfss, na.rm=TRUE, probs=.005)
highCutoff &lt;- quantile(~height, data=brfss, na.rm=TRUE, probs=.995)
heightSubset &lt;- brfss %&gt;%
filter(height &gt;= lowCutoff &amp; height &lt;= highCutoff)</code></pre>
<p>Now draw the filtered histogram:</p>
<pre class="{r}"><code>histogram(~height, data=heightSubset)</code></pre>
<p>Describe what you see. Can you explain why it looks like that?</p></li>
<li><p>There is not <em>really</em> a gap in the middle of the data. The appearance of a break is coming from integer data interacting badly with the breakpoints for creating the histogram bins. One way to fix this is to put breaks specifically at all the “.5” marks on the horizonatal axis:</p>
<pre class="{r}"><code>myBreaks &lt;- seq(from=lowCutoff - 0.5, to=highCutoff + 0.5, by=1)
myBreaks
histogram(~height, data=heightSubset, breaks=myBreaks)</code></pre>
<p>Describe the height distribution. Be sure to discuss, what are the typical heights for these respondents.</p></li>
</ol>
<h2 id="height-and-sex">Height and Sex</h2>
<ol start="17" style="list-style-type: decimal">
<li><p>Because of the difference in average heights for males as compared to females, we might have expected the histogram to be clearly bimodal. Indeed, with a boxplot we can see this difference (include a <code>bwplot</code> of <code>sex~height</code> in your response to this question). Can you explain why the histogram does not show a clear bimodal pattern?</p>
<p>As a companion to the <code>bwplot</code>, let’s also make a histogram which is paneled by sex. Notice the use of the formula <code>~height|sex</code> for height versus sex, and the <code>layout=c(1,2)</code> option for forcing the panels to line up vertically (1 column, 2 rows):</p>
<pre class="{r}"><code>histogram(~height|sex, data=heightSubset, breaks=myBreaks, layout=c(1,2))</code></pre></li>
</ol>
<h2 id="height-and-weight">Height and Weight</h2>
<p>In this section we investigate the relationship between <code>height</code> and <code>weight</code> for our respondents. Because the data file is huge (over 1.3 million rows), we can save computing time by working with a random sample of the rows.</p>
<ol start="18" style="list-style-type: decimal">
<li>Use the following commands to make a scatterplot of weight versus height for a sample of 30,000 rows from the <code>brfss</code> dataset (notice the use of the <code>slice</code> command to use a subset of the rows):</li>
</ol>
<pre class="{r}"><code>mySample &lt;- sample(1:nrow(brfss), 30000)
summary(mySample)
brfssSample &lt;- brfss %&gt;% slice(mySample)
xyplot(weight~height, data=brfssSample)</code></pre>
<p>Describe the overall pattern in the data. Is there a relationship between height and weight for these subjects?</p>
<ol start="19" style="list-style-type: decimal">
<li><p>One way to summarize the data in a scatterplot is to add a smooth fit line (notice that the “line” in this context might be curved). Add the fit line with the <code>panel.loess</code> command (<code>lwd=</code> is an option for setting line width):</p>
<pre class="{r}"><code>ladd(panel.loess(x, y, col=&quot;darkgreen&quot;, lwd=2))</code></pre>
<p>The smooth fit line is almost straight. Does this mean there is a “strong” linear relationship between the two variables? Explain.</p></li>
</ol>
<hr />
<p>TODO: more options: pch, cex</p>
<p>……….</p>
<p>The data in <code>brfss</code> span 15 years; we have data for 2000, 2005, 2010, and 2015.</p>
<ol start="14" style="list-style-type: decimal">
<li><p>Make a stacked bar graph showing <code>age7</code> (age in 10-year increments) vs. <code>year</code> (survey year). What do you learn about the U.S. population over the last 15 years?</p></li>
<li><p>Use <code>tally</code> and <code>barchart</code> to make a graph of the general health level against the survey year, and write a conclusion. What do you learn about general health levels in the U.S. over the time span 2000 to 2015? Provide a plausible explanation for any pattern you see.</p></li>
</ol>
<p>Whenever we notice an association between two variables, we should ask if there are “lurking” variables that might help to explain the association. Age and sex are possible lurking variables in this situation.</p>
<ol start="16" style="list-style-type: decimal">
<li>Use the code provided below to make a graph of general health vs. survey year, broken down (paneled) by age group.</li>
</ol>
<pre class="{r}"><code>myColors = brewer.pal(5, &quot;PuBuGn&quot;)
myKey = list(text=list(levels(brfss$genhealth)), columns=4,
    rectangles=list(col=myColors))
healthVsYearAndAge &lt;- tally(~genhealth|year+age7, data=brfss,
    format=&quot;percent&quot;, useNA=&quot;no&quot;)
healthVsYearAndAge %&gt;% aperm(c(2,3,1)) %&gt;% barchart(col=myColors, key=myKey)</code></pre>
<p>Describe what you see in this final graph. How does it compare with your observations in the previous question? How does this make sense?</p>
<p>=======</p>
<p>Need to introduce mosaicplot at some point.</p>
<ol start="12" style="list-style-type: decimal">
<li><p>As an alternative to the stacked bar graph, we can draw a <code>mosaicplot</code>. A basic 2-variable example shows the relationship between <code>income</code> and <code>health</code> for the <code>brfss</code> participants:</p>
<pre class="{r}"><code>healthVsIncome &lt;- tally(~income+genhealth, data=brfss,useNA=&quot;no&quot;)
healthVsIncome %&gt;% mosaicplot(color=brewer.pal(5,&quot;RdPu&quot;))</code></pre></li>
</ol>
<p>What do we see in this plot? What is the meaning of the varying bar widths? Etc.</p>
</body>
</html>
